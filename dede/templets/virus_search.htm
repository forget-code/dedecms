
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>木马扫描检测插件</title>
<link href="css_body.css" rel="stylesheet" type="text/css" />
<script language="javascript">
function CheckRp(){
  var dp1 = document.getElementById("dp1");
  var dp2 = document.getElementById("dp2");
  var rpct = document.getElementById("rpct");
  if(dp1.checked){
  	document.form1.shortname.value = "php|asp|aspx";
  	rpct.style.display = "none";
  }else{
    document.form1.shortname.value = "php|asp|aspx|htm|html|shtml";
    rpct.style.display = "block";
  }
}
</script>
</head>
<body>
<div class="bodytitle">
	<div class="bodytitleleft"></div>
	<div class="bodytitletxt">辅助插件</div>
</div>
<table width="96%" border="0" cellpadding="1" cellspacing="1" align="center" class="tbtitle" style="background:#E2F5BC;">
  <form action="virus_search.php" name="form1" target="stafrm" method="post">
  <tr> 
    <td height="20" bgcolor="#EDF9D5"> <table width="98%" border="0" cellpadding="0" cellspacing="0">
        <tr> 
            <td width="30%" height="18"><strong>&nbsp;木马扫描检测插件：</strong></td>
          <td width="70%" align="right">&nbsp;</td>
        </tr>
      </table></td>
  </tr>
  <tr>
      <td height="33" bgcolor="#FFFFFF">　　本文件的原理是扫描有可疑操作的PHP文件，或特定规则的文件，对于已经感染病毒的文件，请指定替换内容规则，替换被感染的文件内容，在文件数量非常多的情况下，本操作比较占用服务器资源，请确脚本超时限制时间允许更改，否则可能无法完成操作。</td>
  </tr>
  <tr> 
    <td height="48" bgcolor="#FFFFFF"><table width="100%" border="0" cellpadding="2" cellspacing="2">
          <tr bgcolor="#EBFBE6"> 
            <td><strong>&nbsp;操作类型：</strong></td>
            <td> <input name="dopost" type="radio" id="dp1"  onClick="CheckRp()" value="search" checked>
              扫描文件 
              <input name="dopost" type="radio" id="dp2" value="replace" onClick="CheckRp()" >
              替换内容 </td>
          </tr>
          <tr> 
            <td width="14%"><strong>&nbsp;起始根路径：</strong></td>
            <td width="86%"> <input name="searchpath" type="text" id="searchpath" style="width:60%" value="<?php echo $cfg_basedir;?>">	
            </td> 
          </tr>
          <tr> 
            <td bgcolor="#EBFBE6"><strong>&nbsp;文件规则定义：</strong></td>
            <td bgcolor="#EBFBE6">&nbsp;</td>
          </tr>
          <tr> 
            <td colspan="2"><table width="100%" border="0" cellspacing="1" cellpadding="1">
                <tr> 
                  <td height="30">&nbsp;扩 展 名： 
                    <input name="shortname" type="text" id="shortname" size="20" style="width:200px" value="php|asp|aspx">
                    文件大小：（小于： 
                    <input name="minsize" type="text" id="minsize" value="1" size="2">
                    K 或 大于： 
                    <input name="maxsize" type="text" id="maxsize" value="20" size="2">
                    K） 文件创建日期： 
                    <input name="crday" type="text" id="crday" value="7" size="2">
                    天以内。
                    <hr size="1">
                    （说明：通常情况下PHP木马可能只是几十个字节，要么是20K以上，程序会自动忽略织梦系统大于20K的文件） </td>
                </tr>
              </table></td>
          </tr>
          <tr id="rpct" style="display:none"> 
            <td height="64" colspan="2">
			<table width="100%" border="0" cellspacing="1" cellpadding="1">
                <tr bgcolor="#EDFCE2"> 
                  <td colspan="4"><strong>内容替换选项：</strong>（替换内容请使用正则表达式，替换内容时仅判断扩展名，文件大小、文件创建日期选项会忽略）</td>
                </tr>
                <tr> 
                  <td width="15%">&nbsp;替换内容：</td>
                  <td width="35%"><textarea name="sstr" id="sstr" style="width:90%;height:45px"></textarea></td>
                  <td width="15%">替 换 为：</td>
                  <td><textarea name="rpstr" id="rpstr" style="width:90%;height:45px"></textarea></td>
                </tr>
              </table>
			  </td>
          </tr>
        </table></td>
  </tr>
  <tr> 
    <td height="31" bgcolor="#F8FBFB" align="center">
	<input type="submit" name="Submit" value="开始执行操作" class="inputbut">
	</td>
  </tr>
  </form>
  <tr bgcolor="#E5F9FF"> 
    <td height="20" bgcolor="#EDF9D5"> <table width="100%">
        <tr> 
          <td width="74%"><strong>检测结果：</strong></td>
          <td width="26%" align="right"> <script language='javascript'>
            	function ResizeDiv(obj,ty)
            	{
            		if(ty=="+") document.all[obj].style.pixelHeight += 50;
            		else if(document.all[obj].style.pixelHeight>80) document.all[obj].style.pixelHeight = document.all[obj].style.pixelHeight - 50;
            	}
            	</script>
            [<a href='#' onClick="ResizeDiv('mdv','+');">增大</a>] [<a href='#' onClick="ResizeDiv('mdv','-');">缩小</a>] 
          </td>
        </tr>
      </table></td>
  </tr>
  <tr bgcolor="#FFFFFF"> 
    <td id="mtd">
    	<div id='mdv' style='width:100%;height:100;'> 
        <iframe name="stafrm" frameborder="0" id="stafrm" width="100%" height="100%"></iframe>
      </div>
      <script language="JavaScript">
	    document.all.mdv.style.pixelHeight = screen.height - 420;
	    </script>
	   </td>
  </tr>
</table>
</body>
</html>